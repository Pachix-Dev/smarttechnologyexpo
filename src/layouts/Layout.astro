---
import Navigation from '../components/shared/Navigation.astro'
import '../styles/global.css'
import Footer from '../components/shared/Footer.astro'

interface Props {
  title: string
  description: string
  keywords?: string
  ogImage?: string
  ogType?: string
  canonical?: string
}

const currentLocale = Astro.currentLocale || 'es'
const siteUrl = Astro.site || 'http://smarttechnologyexpo.mx'

const defaultKeywords =
  currentLocale === 'es'
    ? 'Smart Technology Expo, tecnología inteligente México, Industria 4.0, tecnología industrial México, manufactura inteligente, automatización industrial, robotización, Internet of Things, IIoT, transformación digital, fábrica inteligente, smart factory, manufactura aditiva, logística inteligente, expo tecnología, innovación industrial, maquinaria industrial, soluciones industriales, conferencias tecnología, networking industrial, León Guanajuato'
    : 'Smart Technology Expo, smart technology Mexico, Industry 4.0, industrial technology Mexico, smart manufacturing, industrial automation, robotics, Internet of Things, IIoT, digital transformation, smart factory, additive manufacturing, intelligent logistics, technology expo, industrial innovation, industrial machinery, industrial solutions, technology conferences, industrial networking, León Guanajuato'

const {
  title,
  description,
  keywords = defaultKeywords,
  ogImage = '/img/og-image.jpg',
  ogType = 'website',
  canonical = Astro.url.pathname,
} = Astro.props

const canonicalURL = new URL(canonical, siteUrl).href
const fullOgImage = new URL(ogImage, siteUrl).href
---

<!doctype html>
<html lang={currentLocale}>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <link rel='icon' type='image/svg+xml' href='/favicon.svg' />
    <meta name='generator' content={Astro.generator} />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name='title' content={title} />
    <meta name='description' content={description} />
    <meta name='keywords' content={keywords} />
    <meta name='author' content='Italian German Exhibition Company Mexico' />
    <meta name='robots' content='index, follow' />
    <meta name='language' content={currentLocale} />
    <link rel='canonical' href={canonicalURL} />

    <!-- Open Graph / Facebook -->
    <meta property='og:type' content={ogType} />
    <meta property='og:url' content={canonicalURL} />
    <meta property='og:title' content={title} />
    <meta property='og:description' content={description} />
    <meta property='og:image' content={fullOgImage} />
    <meta
      property='og:locale'
      content={currentLocale === 'es' ? 'es_MX' : 'en_US'}
    />
    <meta property='og:site_name' content='Smart Technology Expo' />

    <!-- Twitter Card -->
    <meta name='twitter:card' content='summary_large_image' />
    <meta name='twitter:url' content={canonicalURL} />
    <meta name='twitter:title' content={title} />
    <meta name='twitter:description' content={description} />
    <meta name='twitter:image' content={fullOgImage} />

    <!-- Alternate Languages -->
    <link
      rel='alternate'
      hreflang='es'
      href={new URL(Astro.url.pathname.replace('/en/', '/'), siteUrl).href}
    />
    <link
      rel='alternate'
      hreflang='en'
      href={new URL('/en' + Astro.url.pathname, siteUrl).href}
    />
    <link
      rel='alternate'
      hreflang='x-default'
      href={new URL('/', siteUrl).href}
    />

    <!-- Preconnect for performance -->
    <link rel='preconnect' href='https://unpkg.com' />
    <link rel='dns-prefetch' href='https://unpkg.com' />

    <!-- Structured Data (JSON-LD) -->
    <script
      type='application/ld+json'
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'Event',
        name: 'Smart Technology Expo 2026',
        description: description,
        url: siteUrl,
        startDate: '2026-11-18',
        endDate: '2026-11-20',
        eventStatus: 'https://schema.org/EventScheduled',
        eventAttendanceMode: 'https://schema.org/OfflineEventAttendanceMode',
        location: {
          '@type': 'Place',
          name: 'EXPO GUADALAJARA',
          address: {
            '@type': 'PostalAddress',
            addressLocality: 'Guadalajara',
            addressRegion: 'Jalisco',
            addressCountry: 'MX',
          },
        },
        organizer: {
          '@type': 'Organization',
          name: 'Italian German Exhibition Company Mexico',
          url: siteUrl,
        },
        image: fullOgImage,
      })}
    />

    <link href='https://unpkg.com/aos@2.3.1/dist/aos.css' rel='stylesheet' />
  </head>
  <body>
    <header>
      <Navigation />
    </header>
    <main>
      <slot />
    </main>
    <Footer />
    <script
      is:inline
      data-astro-rerun
      src='https://unpkg.com/aos@2.3.1/dist/aos.js'></script>
    <script data-astro-rerun>
      AOS.init()
    </script>
    <script is:inline data-astro-rerun>
      // Agregar interactividad suave
      document.addEventListener('DOMContentLoaded', function () {
        // Crear partículas flotantes ocasionales
        function createParticle() {
          const particle = document.createElement('div')
          particle.className = 'particle'
          particle.style.left = Math.random() * 100 + '%'
          particle.style.width = Math.random() * 4 + 2 + 'px'
          particle.style.height = particle.style.width
          particle.style.animationDelay = Math.random() * 2 + 's'

          document.body.appendChild(particle)

          setTimeout(() => {
            particle.remove()
          }, 8000)
        }

        // Crear partículas cada cierto tiempo
        setInterval(createParticle, 3000)

        // Efecto de partículas en el cursor
        document.addEventListener('mousemove', function (e) {
          const cursor = document.createElement('div')
          cursor.style.position = 'fixed'
          cursor.style.left = e.clientX + 'px'
          cursor.style.top = e.clientY + 'px'
          cursor.style.width = '6px'
          cursor.style.height = '6px'
          cursor.style.background = '#ED332D'
          cursor.style.borderRadius = '50%'
          cursor.style.pointerEvents = 'none'
          cursor.style.zIndex = '9999'
          cursor.style.animation = 'fadeOut 1s ease-out forwards'

          document.body.appendChild(cursor)

          setTimeout(() => {
            cursor.remove()
          }, 1000)
        })

        // CSS para la animación de desvanecimiento
        const style = document.createElement('style')
        style.textContent = `
                @keyframes fadeOut {
                    0% {
                        opacity: 1;
                        transform: scale(1);
                    }
                    100% {
                        opacity: 0;
                        transform: scale(2);
                    }
                }
            `
        document.head.appendChild(style)
      })
    </script>
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
    font-family: system-ui, sans-serif;
    background-color: #f8f9fa;
  }

  .language-switcher-container {
    position: absolute;
    top: 1rem;
    right: 2rem;
    z-index: 1000;
  }

  main {
    min-height: calc(100vh - 80px);
  }
</style>
